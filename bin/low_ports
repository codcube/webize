#!/bin/sh
dns_port=1053
http_port=8000
http_port=8443

#DNS
sudo iptables -t nat -A OUTPUT -p tcp -d 127.0.0.1 --dport 53 -j REDIRECT --to-ports $dns_port  # simulate port 53 listener
sudo iptables -t nat -A OUTPUT -p udp -d 127.0.0.1 --dport 53 -j REDIRECT --to-ports $dns_port

#HTTP
sudo iptables -t nat -A OUTPUT -p tcp -d 127.0.0.1 --dport 80 -j REDIRECT --to-ports $http_port # simulate port 80 listener

# HTTPS
#sudo iptables  -t nat -A OUTPUT -p tcp -d 127.0.0.1 --dport 443 -j REDIRECT --to-ports $https_port -m owner ! --uid-owner $1 # simulate port 443 listener
#sudo ip6tables -t nat -A OUTPUT -p tcp -d ::1       --dport 443 -j REDIRECT --to-ports $https_port -m owner ! --uid-owner $1
